; [env:esp32s3]
; platform = espressif32
; board = esp32-s3-devkitc-1
; framework = arduino

; ;; Library dependencies
; lib_deps =
;     thomasfredericks/Bounce2 @ ^2.71
;     gin66/FastAccelStepper
;     madhephaestus/ESP32Servo @ ^3.0.6

; ;; Monitor settings
; monitor_speed = 115200
; monitor_port = /dev/cu.usbserial-*
; monitor_filters = esp32_exception_decoder, time, colorize

; ;; Optimized build flags for faster uploads and better performance
; build_unflags = -Os
; build_flags = 
;     -O2
;     -DCORE_DEBUG_LEVEL=0  ; Reduced debug level for faster uploads
;     -DDEBUG_ESP_PORT=Serial
;     -Wall
;     -Wextra
;     -ffunction-sections
;     -fdata-sections

; ;; Enable exception handling
; build_type = release

; ;; OTA upload configuration - OPTIMIZED
; upload_protocol = espota
; upload_port = 192.168.1.249
; upload_flags = 
;     --timeout=30
;     --progress
;     --debug

; ;; Fast USB upload fallback (uncomment to use USB instead of OTA)
; ; upload_port = /dev/cu.usbmodem*
; ; upload_speed = 921600
; ; upload_protocol = esptool

; ;; ESP32 specific options for faster performance
; board_build.flash_mode = dio
; board_build.f_flash = 80000000L
; board_build.f_cpu = 240000000L

; ;; Enable better error reporting
; check_tool = cppcheck
; check_flags = --enable=all

; Alternative USB upload environment for when OTA is too slow
[env:esp32s3_usb]
extends = env:esp32s3
upload_protocol = esptool
upload_port = /dev/cu.usbmodem*
upload_speed = 921600
build_flags = 
    -O2
    -DCORE_DEBUG_LEVEL=0
    -Wall
    -Wextra